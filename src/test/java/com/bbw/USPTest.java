package com.bbw;

import com.alibaba.druid.support.json.JSONUtils;
import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;
import com.baomidou.mybatisplus.mapper.EntityWrapper;
import com.baomidou.mybatisplus.plugins.Page;
import com.bbw.common.JSONUtil;
import com.bbw.common.ListUtil;
import com.bbw.common.PowerRandom;
import com.bbw.db.Query;
import com.bbw.god.activity.game.GameActivity;
import com.bbw.god.activity.worldcup.entity.UserQuizKingInfo;
import com.bbw.god.activity.worldcup.rd.RdUserBet;
import com.bbw.god.db.entity.UserSpecialCardRankEntity;
import com.bbw.god.db.service.UserSpecialCardRankService;
import com.bbw.god.game.data.GameDataService;
import com.bbw.god.game.wanxianzhen.WanXianTool;
import com.bbw.god.game.zxz.cfg.CfgZxzEntryEntity;
import com.bbw.god.game.zxz.cfg.ZxzEntryTool;
import com.bbw.god.game.zxz.entity.ZxzEntry;
import com.bbw.god.gameuser.card.UserCard;
import com.bbw.god.gameuser.card.UserCardService;
import com.bbw.god.gameuser.card.equipment.CfgXianJueTool;
import com.bbw.god.gameuser.card.equipment.cfg.CardEquipmentAddition;
import org.junit.Assert;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import java.io.IOException;
import java.io.InputStream;
import java.util.*;
import java.util.stream.Collectors;

/**
 * @author：lwb
 * @date: 2020/12/2 16:05
 * @version: 1.0
 */
@RunWith(SpringRunner.class)
@SpringBootTest(classes = { LogicServerApplication.class }) // 指定启动类
public class USPTest {
    @Autowired
    private UserSpecialCardRankService userSpecialCardRankService;
    @Autowired
    private GameDataService gameDataService;
    @Autowired
    private UserCardService userCardService;

    @Test
    public void test(){
        EntityWrapper<UserSpecialCardRankEntity> ew=new EntityWrapper<>();
        ew.eq("fight_type",1000).eq("card_id",321);
        int selectCount = userSpecialCardRankService.selectCount(ew);
        if (selectCount>=2) {
            //删除多余的，倒叙查询出多余的数据
            ew.orderBy("fight_rank", false);
            Map<String, Object> params = new HashMap<>();
            params.put("limit", String.valueOf(selectCount - 1));
            Page<UserSpecialCardRankEntity> page = userSpecialCardRankService.selectPage(new Query<UserSpecialCardRankEntity>(params).getPage(), ew);
            List<UserSpecialCardRankEntity> records = page.getRecords();
            for (UserSpecialCardRankEntity entity:records){
                System.err.println(entity.getId());
            }
        }
    }
    @Test
    public void test3(){
        List<Long> a = Arrays.asList(201013227600229L,190516000321547L,211002239500068L,221022243200017L,210325228701269L,211016239600020L,190516207803197L,190516031511778L,220501251200003L,220917252300015L,221024252500766L,221119243400015L,190516106600435L,210814239100013L,221120243400195L,221015252500026L,200716226801399L,210918240100148L,190516000314807L,221119243400026L,210320228800065L,220924242900075L,221002243000140L,220312250800002L,220728251800664L,190516106300492L,220512241900365L,220408241600609L,190516000319928L,220924252300472L,200307225500035L,221107252600642L,221119252700447L,221016252500179L,221105243300101L,220620242200225L,220301207804588L,190516031510624L,220826800100831L,221112252700003L,220726251800393L,210805239000294L,220409251000003L,220813242600012L,220416241700059L,201031227700650L,190516106605323L,220709251700008L,221014239700369L,190516106601749L,220918252300139L,221119243400105L,211010240300099L,220709251700010L,220416241700048L,220929242900481L,221014243100018L,220218250600137L,200503226300225L,221119237300319L,200209234500214L,190515210200352L,220614242100553L,210221228600041L,220511241900303L,221001252400009L,220720251701677L,191214224500007L,220924242700891L,201215228000938L,221014252400980L,221015252500032L,221015243100171L,190515209800973L,210822229900219L,221002243000068L,190516208001499L,220426241700721L,220920252300254L,200604235400129L,190509208403705L,220825800000050L,190516208001013L,190429207100738L,221012252400814L,190710223300798L,210904240000030L,221031243200822L,190903223601271L,211226250200120L,201111227800539L,210831009600001L,221113243300725L,220821252000156L,190516208800256L,190515212000405L,221121252700633L,210320228800002L,200509226400142L,220619242200177L,220611251500014L,220821242600651L,220626500100731L,220804241601106L,211204240700039L,201023227601020L,190515210601196L,210724229700040L,200204225001108L,220317250800177L,200912227300032L,210408228900594L,201205228000071L,210418237600011L,210131228400367L,190516106607763L,220921242801036L,220923242700888L,220129250400395L,201107227800003L,210514228801380L,210316237300205L,200818226801679L,220415241501084L,220930242900555L,211212240700632L,190516208500877L,201011227600026L,211205239900258L,190509207900947L,200901235900190L,210319228701183L,200116234300036L,220505223102025L,210429237800496L,220202241100551L,220922242801070L,220505223001890L,220226250700013L,200816227100291L,221027243100733L,201007227500588L,220505223501456L,200829227200048L,220507241900008L,190516031509097L,220827242700068L,210724229700041L,211207240700284L,220505223201418L,201123227400719L,221017252500279L,210918229701712L,221121800301692L,210108236900063L,221120243400179L,201123227500927L,220708251601618L,221105243300006L,220505223301094L,221005252400270L,201205228000134L,220420251000216L,220320241500205L,221116243300861L,220202250500124L,201222228100373L,210918229801563L,220528251400006L,220806251900136L,190516000313422L,221119243400038L,210103228200192L,190516031502495L,190516106503409L,210918229901352L,220728251800703L,220824252000577L,210130228400063L,221122243400336L,201023236400484L,211210240700467L,211218240800081L,220712251700675L,210211228500017L,200218225200947L,221020243100582L,210502237900324L,220510251200367L,221019243100509L,201113227500918L,200610235400192L,221112243300615L,220326250900053L,220101240900027L,221030252600166L,200620226700015L,210323228800418L,220115241000079L,220219241300066L,190921223401270L,190908223800277L,200613235500016L,220423241700556L,210114228201136L,190516208001493L,220823800100615L,210111228200918L,211113240500660L,221116243300859L,210610238500425L,210420009600014L,220305241400085L,221108243100810L,210320228800013L,220809251900947L,221027252501058L,221119243400032L,210722238900174L,220808251900681L,221018239700370L,200414225201982L,221119243400104L,221103252201139L,221001252400032L,221119243400115L,211017239600048L,210925239400014L,201116206900008L,210504237901044L,190515210201075L,210404237500008L,220620242200226L,221020243100549L,201212236800012L,190510210300095L,221119252700496L,221119243400014L,190516031502322L,220307241201035L,190516000321659L,210620229400884L,210527229201047L,200425226200029L,221121243400211L,220910252200003L,200307225500073L,210429009600023L,221120252700530L,200926227400034L,220827242700050L,190510210300776L,221120252201146L,210116228300003L,210624229401131L,221122243400321L,190710223201299L,220924242900047L,190515210800031L,220521242000047L,190515209800787L,201220228100193L,221122243400337L,210410228900763L,190712223400006L,201117206900014L,210104228200271L,220709251700107L,190516208500038L,210620238700130L,220723251800021L,220605251400323L,221119252700429L,200324225700723L,190516208000609L,220824252000659L,220925242900163L,220724242400577L,220708242301336L,221122243400279L,220416241700058L,220919242800854L,210731239000073L,201121227900114L,211113240500601L,200222225300015L,221120243301076L,221120252700519L,220131250500014L,221022252500552L,221119243400016L,220730242500042L,220830242700278L,190515209300549L,220823242600754L,200718226900002L,211127239900028L,210615238600194L,220309250700319L,210725238900231L,221004243000302L,221120252700579L,221119243400056L,211005240200548L,221122243400338L,221121252700663L,221122243400275L,221019243100544L,220701242205118L,221112252700035L,220903252100036L,221122243400339L,220329241500778L,220813242600033L,210211228500024L,221006243000536L,210924240001179L,210515229200063L,221002243000053L,221109252600706L,220424241700593L,220303250700237L,210915240000968L,221122243400340L,190525223000968L,221122252700671L,221028252501172L,220624242000728L,220829252001062L,220813242600034L,200302225400345L,221122252700672L,220827242700010L,200430226200658L,201119206900021L,220709251700013L,221104252600490L,220910252200025L,210717229600914L,221002243000046L,190516031511328L,221011252400714L,221028243200539L,221105243300005L,190726223500071L,200822236000009L,220927252300592L,221122800301701L,220514251300002L,220709251700172L,221122252700673L,220613251500193L,221112252700023L,221122243301081L,190516031501810L,210630238700714L,221022243200050L,220910500100815L,220903242700550L,221021243100683L,221118207014688L,221107250101842L,221029243200691L,221119243400021L,200428226200445L,220813242600070L,220914252200751L,210415228901141L,190517207013301L,201208500700213L,221119252700449L,221110243300487L,221029252600142L,221119243400023L,200308225002056L,221002243000011L,210403228900065L,220927242900313L,200814227001491L,221025252500826L,221022243200047L,221105243300027L,220813242600008L,221023243200192L,221119243400006L,221118243300982L,221112243300596L,221014243100033L,220910252200006L,221001252400018L,220803251801246L,220831252001230L,221119243400043L,200425226200142L,210427237800110L,221112252700009L,190515210401223L,220816242600323L,221028243200542L,201029227700472L,210213228500498L,220921228801402L,220702242300029L,221002243000098L,190516031505370L,221116243300864L,220820252000003L,221006243000510L,221122243400341L,190516106604112L,221119243400063L,200521235300230L,220917242800640L,221022243200013L,221119252700404L,201004227500237L,221122800101118L,221105243300062L,221006243000481L,220912242800349L,221022243200031L,220708251601647L,210317228701070L,220919252300242L,220205241200061L,200328225800004L,190516106300983L,221105243300052L,201123206900027L,220624251500731L,191014233600056L,221113252700144L,221011243000860L,220925800301012L,221105243300047L,220903252100025L,221120252700561L,220423251100012L,221001252400024L,221118243301050L,221120252700584L,220920242800950L,190515210600090L,221112252700027L,221120252700501L,220109250300159L,220713251601753L,221112800301598L,221110243300472L,221107252600631L,220806251900184L,221002243000035L,210316228701025L,190509209401277L,220922252300380L,221029243200683L,220308207804590L,201113500100091L,190510210300020L,200426235100091L,220514251300014L,210710229600022L,221122243400342L,220710251700449L,221004500100842L,221118252700329L,221019252500380L,201027236400554L,220301250700153L,221119243400064L,220720242400350L,220221250600179L,221121252700655L,221119243400058L,220920252300321L,221119243400033L,200331234800412L,220502206900128L,220922800300899L,220820252000020L,221005252400253L,221105000322944L,221029252600027L,220823252000475L,200222225300275L,221119252700485L,211030239700006L,220618242200053L,210221228600031L,210701229500618L,221001252400023L,201129227900848L,190510210100976L,221022243200027L,210414228901055L,190510210101204L,221119243400057L,221118252700351L,221001252400004L,221015252500089L,220101240900011L,220908242700840L,190510210101213L,221029252600012L,221029252600039L,220917252300024L,190510210101217L,200227225301401L,220919252300176L,210125228301214L,211228250200193L,200123224501264L,190515210200331L,211206240700234L,221014243100046L,190516207201045L,211120240600155L,210112228201012L,190515210601401L,200115224700995L,200321225700011L,221015252500118L,221122243400343L,221019243100533L,190516106604907L,190516031502524L,220913500100823L,221119252700490L,220214241200706L,190510210300752L,221116031512177L,190510210101218L,211005239500168L,221004243000290L,221014243100090L,190510210101219L,221122243400344L,190510210101221L,191214224500148L,200718226801569L,190510210101224L,221015242900713L,210320228800014L,190510210100888L,210805239000300L,221012252400841L,190516106606060L,221118800301654L,220405241600355L,210628238700625L,221112243300625L,201030227700529L,221027243200479L,190516208500240L,221119243400029L,221023252500681L,220912252200470L,210529229300003L,221119243400092L,221120243400184L,221105243300065L,190509208403416L,220709251700006L,220914206900155L,201214228000893L,200221225201740L,221029243200619L,221014243100004L,221106243300237L,220813242600056L,220911242800254L,220920242800910L,221014243100031L,190516208000393L,221109243300403L,190515212300133L,221104252600461L,221022252500625L,221121252700631L,221002243000023L,221105243300034L,201125500100687L,221027243200454L,220910242800135L,221029252600014L,210711229600256L,221118252700326L,211023240400006L,220820252000002L,221120252700524L,220802242500295L,190509208101767L,220728251800693L,200218234600278L,221002252400137L,220403250900167L,191207234000036L,221105243300014L,221122243400345L,190515210800962L,220903252100014L,210506229001151L,221101243200936L,220714242301666L,221029243200643L,221029252600003L,221020252500430L,221119243400003L,220920800200004L,220614242100562L,200328225800126L,221113252700161L,190516207800912L,220520241900776L,220326250800319L,221119243400009L,220514251300021L,190516000321859L,220712251700695L,221112252700007L,221014243100048L,221014243100044L,200111224700063L,190510209702058L,221018243100398L,190516207802181L,190611212400292L,190821000322405L,221002243000007L,220915251300306L,190515209300254L,221119243400004L,191116224300004L,220716251701184L,220704251601042L,211105240400774L,220827242700016L,190817031512074L,221111252600850L,190510210100893L,221107252600646L,221004252400224L,221119243400011L,190509209600370L,210609229300965L,210405228900343L,220713251700779L,221006252400366L,191123223801249L,200307234700363L,190516106605459L,210824229900398L,221029252600013L,221120252700541L,210128237000081L,220504251200165L,220703251600861L,210724229700181L,210424237700022L,210308228601275L,221105243300082L,200912227300052L,220225241300514L,200204225001005L,220927242900345L,200305225401123L,220813242600020L,221029252600023L,221122252401103L,220419241700264L,200320225601365L,220917252300033L,220716242400056L,190515211200118L,221119243400066L,210929239400243L,210911239300006L,220621238800525L,201125206900029L,190516000320328L,220129241100006L,201122500301166L,221122243400333L,210606229101188L,221113243300669L,211114240300934L,220827252000884L,190516207801000L,221008243000687L,220917252300010L,221008252400463L,211011240300244L,221117252700298L,220421241700427L,210422237600537L,190515210401090L,190515209200331L,190515211600153L,221002243000002L,221122800301722L,190509207900123L,221002252400101L,221014243100011L,210612238600034L,221117252700307L,221025243200319L,220903252100127L,221003251100375L,220907242700746L,220725251800307L,221013252400936L,221004242900687L,210712229600307L,221026227001645L,221029243200678L,210926239400143L,221122243400346L,220131250500052L,221029252600018L,221122243400347L,221122243100826L,210419237600060L,221122252700667L,221029252600020L,190515209300074L,220921800300562L,210814239100003L,221012243000899L,221029252600002L,220409250900285L,220813242600013L,210130228400030L,221030243200780L,220813242600053L,220619242200174L,221121252700624L,210626229500004L,200221225201553L,221122243400348L,211019240300725L,210415009600008L,221109252600771L,221018243100431L,220911242800277L,210902229901174L,221122243400349L,210620238700139L,220906242700710L,221105243300044L,220901242700442L,220926242900215L,191024224100424L,221119243400045L,221119243400070L,190510210700806L,221001242900650L,220811242500795L,221105243300144L,220219227201433L,220716242400051L,200426226001114L,221107252600656L,220913252200644L,221112252600872L,221122243400272L,211204240700098L,221119243400007L,220907242700738L,190509207508989L,211204239900241L,211102240400603L,190515210001116L,221121243400216L,220813242600067L,220910242800109L,220817242600378L,221029252600100L,190515211600133L,221003243000162L,221003243000200L,190515212000465L,220705251601229L,220426227101655L,220929238001055L,200822227100871L,220416229001212L,221116243300855L,220416240001246L,221009241601114L,221119243400046L,220504251200142L,221107243300256L,220912252200494L,220416241001106L,211028206900104L,220604242100034L,220820252000032L,210320228800092L,221110252600814L,221105243300012L,221121252700615L,220215241200764L,220416241100887L,221015252500002L,221021243100691L,221121252201147L,211211250100042L,210918240100032L,221111252600855L,211009239500278L,220701242000738L,221029252600058L,221120243400132L,210912240000795L,220424251100105L,221119243400061L,220129241100004L,190509208100516L,220625251600010L,220915242800580L,220309241400297L,220512241900351L,220811251901195L,220921800300280L,221023252401055L,210113228201038L,220620251500534L,220627242100827L,221114252700180L,220928242900405L,221014243100039L,221026252500969L,221120252700596L,210810229800479L,200927227400256L,220625242200752L,210810229800500L,210505229100537L,220702242300152L,221015243100151L,220702242300041L,201113500100025L,220806251900032L,221119243400091L,190516208500089L,210320228800022L,220716242400090L,220722251701778L,220921800300002L,221105243300026L,220930242500903L,220319241500083L,200201225000039L,221027252501001L,200725235800018L,221005243000443L,220813242600138L,221122243400282L,221122243400350L,221030252600163L,201126227900604L,211121240600259L,220814242600209L,210320228800058L,221122243400351L,200723235700165L,220902242700459L,200723235600196L,221106243300182L,221119243301056L,220907242700784L,220903252100019L,201024227700008L,210812229800759L,221122243400352L,221017243100362L,220917242800651L,221014243100010L,201205228000104L,211120240600021L,220815242600317L,201109227800284L,220315250800127L,210807229800048L,221117243300974L,221106243300248L,211101206900109L,220907251801617L,220419241700296L,220927242900309L,210125228301223L,221118243300998L,221015243100125L,210424237700441L,190516000316417L,220823800100137L,210629229500444L,221116252700263L,200510226400229L,220625251600016L,210126228301232L,220807251900495L,221027252501048L,221118243300996L,190516000321513L,221119252700424L,210501229100017L,201125227900500L,221122252700664L,220918242800829L,221013207103385L,221015243100146L,210613229400143L,221119252700418L,221015243100195L,220923008600001L,221014243100006L,221010252400627L,220909242800004L,221102243100796L,221119252700480L,220707251601555L,211023240400112L,220617251500382L,221120243400172L,221121243400212L,221122243400353L,221122243400354L,221122227500952L,210804229701429L,210427237800049L,221024243200252L,220514251300020L,210801239000161L,190516000319786L,221002243000018L,190716233000035L,210605238500007L,200914236100143L,220102240900125L,201209228000518L,210723238900189L,190701223300024L,221015252500020L,220627251600195L,221119252700434L,221112252700029L,220930242900526L,201117236600151L,220823242600771L,220709242301420L,221029252600065L,221121252700639L,200423226100726L,190509208402869L,221020252500440L,221030243200700L,220723251800086L,221002242900676L,220416241700036L,221119252700482L,220113240900811L,220320241500183L,190510209900044L,210925239400010L,220427500900001L,221118243301032L,220915242800561L,220913228801401L,221116243300884L,221122252700674L,190515210200290L,220618242200033L,220810251901063L,220803251601784L,221105243300007L,211004240200471L,190727223500162L,221122243400297L,221120252700534L,220728251800590L,220730242500090L,221120252700522L,221122243400355L,220301225002107L,221118243301006L,221016243100290L,221120252700544L,220429251100293L,220706251601284L,220828800100869L,221119252700384L,221105243300033L,221119252700409L,221007252400441L,221013243000953L,221112252700020L,221119252700388L,220705251601132L,221027800301447L,210902229901145L,210225228600472L,221015252500029L,220909242800048L,211031240400533L,200927227400224L,220909242800037L,221120243400186L,221116243300914L,221103242100961L,220728242400728L,190515210001127L,211105239700168L,191112224200890L,221004243000269L,221104243201116L,200624226700484L,210601229300368L,221120252700552L,221119243400019L,221122243400356L,221112252700012L,220709251700053L,220909242800032L,220303241300854L,220624242200417L,190516031511500L,210513228801378L,210306228700185L,210424237600902L,220909242800033L,221112252700032L,221114243300768L,210913240000849L,210321228800166L,221029243200677L,221122243400293L,200603235200219L,210914239300260L,220805242500468L,211001240001195L,221115243300793L,221107252600628L,220909242800023L,190525223001046L,190429207305122L,220521242000005L,191225224500974L,220709251700164L,190515209500201L,190515212300318L,220827242700014L,220907252100317L,221120252700575L,220806251900011L,221122243400357L,200321225700006L,211218240800039L,200725235800037L,220730242500083L,221118252700361L,221122243400358L,190509207900515L,201115227500921L,220608242100275L,221110242801222L,221119252700460L,221029252600043L,210226228600640L,220917252300011L,220703251600982L,220828252000955L,221122243400359L,221119800301669L,221001242900595L,220724242400576L,210531238400224L,221119243400090L,220829242700231L,221105252600493L,220920252300258L,220109240900548L,221107252600638L,221016243100287L,220720242400348L,220903252100022L);
        List<Long> B = Arrays.asList(210620229400884L,221015252500089L,221002243000046L,221119243400056L,220131250500014L,221009252400617L,190517207013301L,221015252500004L,200222225300015L,220827242700068L,221029243200691L,200223225300411L,220720242400350L,221118252700326L,200521235300230L,221105243300014L,221107250101842L,220129241100006L,220605251400323L,220825252000695L,220423251100012L,190509208101767L,221105243300065L,201113227500918L,221031243200822L,220302250700217L,190510210100888L,190516031502322L,201107227800003L,201205228000071L,221023243200192L,211004240200471L,221029252600058L,190817031512074L,221029252600039L,220813242600012L,220707242301265L,220913500100823L,220909242800005L,220723251800021L,200822227100871L,220521242000014L,210323228800418L,200414225201982L,190516106600435L,190525223000968L,221030252600166L,220902242700459L,220514251300014L,221105243300012L,190516106300983L,220423251100025L,221015243001024L,221022243200047L,210527229201047L,190509207900123L,221119243400110L,210714229600582L,210822229900219L,220708242301336L,220709251700053L,220501251200003L,210221228600041L,220909242800032L,220918252300139L,221020243100549L,210514228801380L,210211228500024L,190516031511973L,221015252500026L,210418237600011L,220716251701187L,220809242500694L,220225241300514L,200307225500035L,220716242400016L,220716251701184L,220617251500382L,191112224200890L,210918240100032L,210812229800759L,220730242500035L,220709251700008L,220929238001055L,220403250900167L,220710251700331L,200328225800004L,221008243000687L,221001252400004L,221119243400003L,221112252700027L,220713251700779L,210929239400243L,220917252300024L,220514251300002L,200428226200445L,210914239300260L,221027243200476L,210306228700185L,221002243000098L,220809251900947L,190510210300095L,220624242000728L,221014243100046L,220620251500534L,211218240800039L,220712251700675L,220827242700016L,220723251800082L,200307225500073L,210217228501129L,200620226700015L,211127239900007L,190611212400292L,200426235100091L,221004243000302L,190817223600714L,221014243100048L,221029252600003L,200716226801399L,221106252600563L,220917252300010L,190515210601196L,220813242600033L,220829252001062L,190515210001116L,220218250600137L,220910242800135L,200503226300225L,220913228801401L,200222225300275L,190516031502495L,220514251300020L,210403228900065L,210807229800048L,220430241800082L,210414228901055L,210724229700041L,210320228800002L,220520241900776L,190516207201045L,221023252500681L,200426226001114L,200123224501264L,190515210201075L,220507241900008L,220504251200165L,220811251901195L,220730242500042L,211028206900104L,210810229800500L,190516000320328L,220830242700300L,220901242700442L,210109228200687L,220221207509612L,211219240800128L,221016252500179L,220512241900365L,221014243100006L,221014243100033L,211019240300725L,220620242200226L,220919252300178L,210128237000081L,220909242800023L,220720251701677L,201123206900027L,220813242600030L,220504251200142L,221011252400714L,220621242200290L,221005252400270L,220820252000020L,220813242600053L,220907242700746L,221026243200397L,190515212000405L,221105243300044L,220903252100014L,220709242301420L,220820242600606L,190516106606060L,221030243200748L,221015252500016L,221113252700140L,220920242800910L,191116224300004L,190515210800031L,210415228901157L,190515210200290L,220803251801246L,220920242800950L,221105243300101L,220730242500090L,220722251701778L,221020243100582L,191225224500974L,190516000318312L,211121239800217L,221031252600237L,200929227400409L,220913242800407L,220805242301779L,220827252000875L,221015252500003L,220918242800829L,220914242800458L,210425237700936L,220728251800664L,221015252500118L,221029252600012L,221026252500867L,221119243400064L,200201225000039L,220409251000003L,221010243000828L,201117206900014L,221119252700496L,220829252001095L,221115243300843L,221102243200967L,221026243200373L,221119243400091L,220723251800070L,221119252700394L,221120252700501L,211227240800624L,220429251100293L,220708251601618L,221105243300005L,190516000321659L,220409250900285L,221012252400841L,221119243400016L,220914252200751L,220808251900707L,221112252700009L,220906242700710L,221028243200539L,210613229400143L,221120252700541L,190516031506333L,210904240000030L,221119243400033L,221102243200969L,210320228800058L,220907242700738L,220724242400577L,221113252700161L,221029252600008L,210515229200063L,221112243300615L,210130228400030L,190516106607763L,211111206900112L,200305225401123L,221015243100125L,220423241700556L,220729251800777L,221007243000547L,221105243300082L,220831242700324L,221028252501092L,221020252500440L,220723242400511L,210320228800013L,220919252300242L,210427237800110L,221014243100097L,221119252700441L,220726251800393L,221119243400090L,221116243300914L,221014243100031L,220707251601452L,221003243000162L,220910252200004L,221112243300625L,220817242600378L,221019243100509L,221008252400463L,220910252200003L,220728251800693L,220730242500047L,211017239600048L,221022243200010L,190510210300020L,210424237700441L,190516106300492L,210802239000205L,190516207800912L,220319241500014L,220426241700721L,221011242900707L,220920252300254L,210813229800877L,190516000316417L,221012252400791L,190622223200699L,190515210600090L,220903252100045L,221119243400004L,200912227300052L,221014243100010L,210113228201038L,200718226801569L,211120240600008L,190516106605459L,220113240900811L,210320228800014L,190516106502763L,220416241700058L,220709251700006L,200204225001108L,220823252000475L,221109252600771L,220625251600010L,220131250500052L,221119243400032L,190516208000393L,221017243100362L,190515212300318L,221029252600027L,221119243400046L,200221225201740L,201031227700650L,221105000322944L,221119243400092L,220624242200417L,220424251100105L,201109227800284L,221120252700579L,221004500100842L,221001252400018L,200926227400034L,200814227001491L,220307241201035L,221111252600841L,221022252500552L,221119243400011L,220619242200174L,220109250300159L,210814239100003L,221105243300148L,220709251700172L,221014239700369L,220813242600013L,210911239300006L,221105243300033L,220814242600238L,220315250800127L,190726223500071L,211228250200193L,221001252400023L,221014243100018L,220913252200644L,221006243000510L,200321225700011L,200412226000359L,221105243300023L,221104252600461L,221001252400024L,220808251900681L,221029252600002L,210902229901174L,221119243400066L,210626229500003L,200927227400224L,200502226300008L,220626500100731L,221107252600631L,210221228600031L,220903252100036L,190516031501810L,200410225901501L,220824252000659L,210620238700139L,221014243100011L,210626229500053L,220930242900555L,190701223300024L,190516207201528L,221004242900687L,201023236400484L,221102243201029L,210805239000300L,221105243300046L,221105243300047L,220924252300472L,190908223800277L,211205239900258L,221120243400195L,221002243000068L,220430241800036L,200430226200658L,221107243300281L,221110242801221L,221019252500380L,221110242801225L,221014243100004L,220821242600651L,190516106604907L,221110242801222L,221022243200017L,220705251601132L,221015243100151L,221014252400980L,220730242500083L,220820252000032L,210924240001179L,201116206900008L,210529229300003L,220305241400003L,220709251700013L,211212240700632L,220930242900498L,221112252700032L,221027252501058L,210308228601275L,210610238500425L,220718251701374L,210212237100173L,210104228200271L,220823242600754L,220802242100930L,220416241700059L,211127239900008L,210130228400087L,220704251601042L,220806251900136L,210925239400014L,190509207508989L,220813241300984L,220528251400006L,210624229401131L,190509208403705L,190515209000819L,220402241600070L,220813242600034L,200324225700723L,190516106302238L,220317241400796L,221029252600065L,220909242800048L,200311225501216L,190516207803197L,220820252000002L,221015243100146L,191203224400467L,190510210100893L,221119252700447L,221118243300998L,191214224500039L,201117236600151L,191208234000091L,221002243000002L,211204240700039L,220828252001012L,210116228300003L,211010240300014L,221028243200569L,200116234300036L,210111228200876L,221119243400009L,210722238900174L,200329234900157L,210502237900324L,210226228600640L,220831252001230L,221006243000481L,190509207703693L,220813242600070L,220924242900075L,190515209200331L,221029252600018L,190516031502524L,200613235500016L,220909242800013L,220813242600067L,221112252700012L,220702242300041L,221004243000315L,200604235400129L,220921242800989L,210609229300965L,211113240500660L,221119243400080L,221118243301050L,220927242900309L,211206240700234L,221120252700522L,220816242600323L,220731242500184L,190516000319786L,220604242100034L,221011243000860L,210304228601111L,220109240900546L,210125228301223L,221119252700482L,221015252500020L,200620226700066L,210320228800022L,220927242900280L,221119252700396L,221015252500032L,221121252700646L,210316237300205L,200305225401229L,221120243400172L,220408241600609L,210320228800065L,210725229700207L,220702242300042L,201007227500588L,221027243200454L,220608242100275L,201117206900012L,221120252700569L,210926239400143L,221119243400058L,210628238700625L,190515212300133L,221119237300319L,190509209600370L,221024252500766L,190517207013753L,210404237500008L,220102240900125L,190515209800787L,221015243100171L,220829242700231L,200420226100360L,221110243300487L,221108243100810L,221007242801192L,210824229900398L,211001240200175L,221105243300070L,221119252700485L,210515229200143L,210929239400248L,221112252700029L,190821000322405L,221029252600043L,221029243200643L,190515210200106L,220514251300021L,221017252500279L,221103252600422L,221121252501250L,220416241700048L,220318250800204L,210606229101188L,190509208701554L,221119252700449L,221121252700633L,190516031509097L,210723238900189L,220716242400056L,210424237700049L,220728251800703L,221020252500430L,210731239000073L,190509208402869L,220105240900308L,201228206900039L,190518000322090L,220824252000577L,220625251600016L,221105243300093L,211207240700284L,190903223601271L,220427500900001L,220908242700840L,221026227001645L,200801227000030L,190516207801000L,221029252600014L,221029252600015L,220311241400377L,210429237800496L,210107236900060L,201027236400554L,220912252200494L,220705251601214L,221105243201180L,220917252300033L,211125240600487L,210108236900063L,221021243100700L,220813242600020L,201121227900114L,220730242500059L,220226250700013L,220917252300015L,220830242700278L,190516106604112L,220810251901063L,190516207201818L,221109252600733L,200209234500214L,220701251600688L,210601229300368L,220614242100553L,221004252400224L,190516106503409L,220709251700227L,210710229600022L,191214224500148L,220512241900351L,221002243000023L,210125228301214L,210905240000249L,211114240300934L,221016243001027L,211001240001195L,220806251900041L,220405241600355L,221029252600013L,211005239500168L,220430241800063L,220723251800086L,190509207900947L,220924242900047L,221019252500396L,210710229600044L,220910252200025L,221112252700003L,201129227900848L,221118243301006L,190510210300834L,221119243400019L,221022243200031L,221121243400211L,220920242800924L,221117243300974L,221027243100733L,220806251900032L,200331234800412L,220709251700107L,220912252200470L,220925252300492L,200907227200931L,220910252200006L,200425226200029L,221112252700035L,221106252600578L,221029243200624L,220716242400051L,221016243100271L,220624251500731L,221119243400006L,211030239700006L,221006243000536L,221119252700404L,221114252700180L,211127239900028L,210701229500618L,220926242900215L,220821252000156L,221002252400137L,220317250800177L,210111228200918L,210907239200283L,220202250500124L,190716233000073L,211023240400006L,220129250400395L,210612238600034L,191214224500007L,221113252700144L,220618500100723L,221029243200678L,220703251600861L,190510210300776L,200218234600278L,221001242900650L,210629229500444L,200227225301401L,210126228301232L,221016243001026L,221016243001029L,211226250200120L,190516031500186L,220701500100739L,200307225500025L,221027252501001L,220807251900426L,221027252501048L,191014233600056L,221118252700329L,211002239500068L,221001252400009L,211120240600021L,211120240600155L,220707251601555L,220710251700449L,190510210300752L,211202239900159L,210410228900763L,190525223001046L,200321225700006L,190516106605132L,220922252300380L,191207234000036L,211105240400774L,201030227700529L,221112252700023L,210915240000968L,221013207103385L,220909242800004L,220924242900066L,220728242400728L,220526242000326L,210627229500161L,210717229600914L,221108243300317L,221014243100039L,220709251700103L,200510226400229L,221106243300182L,220415241601001L,211005240200548L,221002252400101L,221115252700232L,221107252600656L,220129241100004L,201111227800539L,221119243400063L,221112243300596L,221004243000269L,220522251300193L,221117252700298L,221012243000899L,211101206900107L,220919242800854L,220319223501454L,220907242700773L,220914206900155L,221002243000011L,221016243100290L,201113500100091L,220705251601229L,220806251900011L,210621238700218L,221015252500123L,201117236400633L,221119252700424L,201214228000893L,221028252501172L,190429207101174L,221113243300725L,221120252700515L,190515211600153L,220814251901614L,221120243400142L,200716226801400L,220221250600179L,200726226901105L,221022243200013L,201113500100025L,221107252600646L,201004227500237L,221119243400002L,221103243201052L,211210240700467L,220701251600599L,210505229100537L,221013252400871L,201125206900029L,220730242500044L,221119243400015L,220820252000003L,221121243400216L,221120243400198L,190510211100018L,200107224601361L,220329241500778L,221122252700664L,221105243300037L,190718233000154L,220813242600138L,190516208000609L,221025252500794L,220618242200053L,220706251601284L,221121252700640L,220923242700888L,221013252400936L,190629232800649L,190510210700806L,190515210200352L,210705229501053L,221105243300052L,220730242500029L,200905227200803L,201001227201371L,210721229601330L,220803251601784L,190516000313422L,220729239902429L,190515210001618L,210107228200471L,200603235200219L,220728251800590L,220320241500205L,220826252000792L,190515210401090L,221122243400272L,220729242400750L,221118243301032L,220814242600209L,221113252700098L,221014243100044L,211106239700184L,221119243400038L,221011242900706L,221026243200428L,221028252300726L,210801239000161L,221029252600028L,220702242300012L,211121239800216L,221004243000290L,220811242500795L,220202241100551L,210630238700714L,221115243300793L,211016239600020L,221119243400021L,220917242800641L,220911242800254L,201029227700472L,210219237100184L,221111243300525L,190516000321859L,220929242900456L,220910500100815L,210403237200258L,190516031509874L,210821229900059L,220709251700164L,221119252700437L,220421241700427L,190710223300798L,190710223201299L,221028243200542L,221024243200254L,220708251601647L,201023227601020L,190516000321547L,190516031511778L,210506229001151L,190712223400006L,220420251000216L,221119243301056L,201013227600229L,210422237600537L,221105243300007L,220505223102025L,201212236800012L,211211250100042L,220928242900405L,190516031511772L,190516000321545L,221002252400113L,220505223001890L,210724229700040L,221107252600638L,221119243400026L,220416241700004L,220822242600719L,221120252700561L,190509208402853L,221122243400280L,220505223201418L,221105243300109L,221105243300083L,221105243300079L,211121240600259L,221106243300200L,221106243300204L,220505223301094L,221104243201116L,221030243200780L,221107243300301L,221122252700668L,190516031510624L,220505223501456L,190921223401270L,200215225200235L,201217500800031L,221026252500930L,221002243000072L,220806251900184L,221117252700307L,220217250600120L,220415241501084L,210626229500004L,220319241500156L,221120252600887L,210501229100017L,211009239500278L,190516106601749L,221121243400229L,220521242000047L,220130250400766L,190516000319928L,221110243300472L,190516000314807L,220903252100025L,200725235800018L,221005252400257L,200723235700165L,211204240700098L,211115239800110L,220925242900163L,220312250800002L,210902229901145L,221118252700351L,220305241400085L,220621238800525L,221105243300027L,220713251601753L,190516208001013L,190516208500038L,190516208500877L,220709251700010L,221119243400105L,220402241600046L,200927227400256L,221120252700584L,221030243200703L,221110252501245L,200718226900002L,221122243400315L,221109252600706L,220712251700695L,221119243400045L,220827242700116L,210531238400224L,220814208101856L,221119243400061L,210620238700130L,221029252501201L,220620242200225L,200209225100536L,220407241600498L,221116243300859L,190726223500070L,221029252600020L,210501237900166L);
            List<Long> c = new ArrayList<>();
            List<Long> d = new ArrayList<>();
            c.addAll(a);
            d.addAll(B);
            d.addAll(B);
            c.removeAll(d);
        System.out.println(c);
    }

    @Test
    public void test7(){
        List<Integer> cards = Arrays.asList(1001,525);
        List<UserCard> userCards = userCardService.getUserCards(210420009600014L, cards);
        System.out.println("userCards = " + userCards);

    }
    @Test
    public void test8(){
        List<CardEquipmentAddition> addition = CfgXianJueTool.getLevelAddition(120,60, 0);
        System.out.println("addition = " + addition);

    }

    @Test
    public void test9(){
        // 等级存量
        int lvStock = 446;
        // 等级上限
        int lvLimit = 12;
        // 词条池
        List<CfgZxzEntryEntity> entrys = ZxzEntryTool.getEntryByType(10);
        List<Integer> entryIds = entrys.stream().map(CfgZxzEntryEntity::getEntryId).collect(Collectors.toList());

        //随机词条
        List<ZxzEntry> randomResults = new ArrayList<>();
        long begin = System.currentTimeMillis();
        randomEntry(randomResults, entryIds, lvLimit, lvStock);
        System.out.println("随机词条耗时：" + (System.currentTimeMillis() - begin));

        //判断结果准确性
        int sumLvAsResult = randomResults.stream().mapToInt(ZxzEntry::getEntryLv).sum();
        Assert.assertEquals(lvStock, sumLvAsResult);

        for (ZxzEntry randomResult : randomResults) {
            System.out.println(randomResult.toString());
            if (randomResult.getEntryLv() > lvLimit) {
                System.err.println(randomResult + " 随机结果超过词条等级上限：" + lvLimit);
            }
        }
    }
    /**
     * 随机词条
     *
     * @param randomResults 随机结果
     * @param entryIds      要随机的词条集合
     * @param lvLimit       随机等级上限
     * @param lvStock       词条等级存量
     * @return
     */
    public void randomEntry(List<ZxzEntry> randomResults, List<Integer> entryIds, Integer lvLimit, int lvStock) {
        if (lvStock <= 0) {
            return;
        }
        List<Integer> excludeEntryIds = new ArrayList<>();
        while (true) {
            //存量等级为0退出循环
            if (lvStock <= 0) {
                break;
            }
            //如果全部随机玩，递归在随机一遍
            if (entryIds.contains(excludeEntryIds)) {
                randomEntry(randomResults, entryIds, lvLimit, lvStock);
                break;
            }

            //随机一个词条
            Integer randomEntryId = PowerRandom.getRandomFromList(entryIds, excludeEntryIds);
            Optional<ZxzEntry> entryOptional = randomResults.stream().filter(tmp -> tmp.getEntryId().equals(randomEntryId)).findFirst();
            int currentEntryLevel = entryOptional.isPresent() ? entryOptional.get().getEntryLv() : 0;

            //可随机等级范围
            int canRandomLv = lvLimit - currentEntryLevel;
            if (canRandomLv <= 0) {
                continue;
            }

            //随机等级
            int randomLv = PowerRandom.getRandomBetween(1, canRandomLv + 1) - 1;

            //处理等级
            if (entryOptional.isPresent()) {
                entryOptional.get().setEntryLv(currentEntryLevel + randomLv);
            } else {
                ZxzEntry zxzEntry = new ZxzEntry(randomEntryId, randomLv);
                randomResults.add(zxzEntry);
            }
            lvStock -= randomLv;
            excludeEntryIds.add(randomEntryId);
        }

    }



}
